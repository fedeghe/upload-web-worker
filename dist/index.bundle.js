(()=>{"use strict";function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}var n={d:(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},e={},u=(n.r(e),n.d(e,{default:()=>m}),new function(){var e=0,t=this;this.prefix="UWW_",this.toString=function(){return e+=1,t.prefix+e}}),t=(self.FormData=r,XMLHttpRequest.prototype.send);function r(){if(!(this instanceof r))return new r;this.boundary="------RWWorkerFormDataBoundary"+Math.random().toString(36);var n=this.data=[];this.__append=function(e){var t,r=0;if("string"==typeof e)for(t=e.length;r<t;r++)n.push(255&e.charCodeAt(r));else if(e&&e.byteLength)for((t=(e="byteOffset"in e?e:new Uint8Array(e)).byteLength);r<t;r++)n.push(255&e[r])}}XMLHttpRequest.prototype.send=function(e){return e instanceof r&&(e.__endedMultipart||e.__append("--"+e.boundary+"--\r\n"),e.__endedMultipart=!0,this.setRequestHeader("Content-Type","multipart/form-data; boundary="+e.boundary),e=new Uint8Array(e.data).buffer),t.call(this,e)},r.prototype.append=function(e,t,r){this.__endedMultipart&&(this.data.length-=this.boundary.length+6,this.__endedMultipart=!1);var n=Object.prototype.toString.call(t),o="--"+this.boundary+'\r\nContent-Disposition: form-data; name="'+e+'"';if(/^\[object (?:Blob|File)(?:Constructor)?\]$/.test(n))return this.append(e,new Uint8Array((new FileReaderSync).readAsArrayBuffer(t)),r||t.name);/^\[object (?:Uint8Array|ArrayBuffer)(?:Constructor)?\]$/.test(n)?(o+='; filename="'+(r||"blob").replace(/"/g,"%22")+'"\r\n',this.__append(o+="Content-Type: application/octet-stream\r\n\r\n"),this.__append(t),o="\r\n"):o+="\r\n\r\n"+t+"\r\n",this.__append(o)};function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d=["file","url","headers","method"];function i(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function c(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function l(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],0<=t.indexOf(r)||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),a=0;a<o.length;a++)r=o[a],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}var o=function(e){e=e.toString();return e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))}(function(){self.requests={},self.onmessage=function(e){var e=e.data,t=e.id,r=e.url,n=e.file,o=e.method,a=e.headers,e=e.action,e=void 0!==e&&e,i=self.requests;if(e)switch(e){case"start-upload":post=!0,i[t]=s({id:t,url:r,file:n,headers:a,method:o,worker:self});break;case"abort-upload":post=!0,t in i&&(i[t].xhr.abort(),i[t].xhr=null,delete i[t])}};var s=function(e){function t(e){a.postMessage({action:"progress",id:r,fileName:o.name,progress:{percent:(100*e.loaded/d).toFixed(2),loaded:e.loaded,total:d}})}var r=e.id,n=e.url,o=e.file,a=e.worker,i=e.method,e=e.headers,s=void 0===e?{}:e,u=new XMLHttpRequest,d=o.size;return(u.upload||u).addEventListener("progress",t),u.addEventListener("loadend",function(){200===u.status&&4===u.readyState&&a.postMessage({action:"end",fileName:o.name,id:r})}),u.addEventListener("error",function(){a.postMessage({action:"error",id:r,fileName:o.name,data:{status:u.status}})}),u.addEventListener("abort",function(){a.postMessage({action:"abort",id:r})}),u.open(i,n,!0),Object.keys(s).forEach(function(e){return u.setRequestHeader(e,s[e])}),u.send(o),a.postMessage({action:"start",id:r,fileName:o.name}),{xhr:u}}}).replace(/\n|\s{2,}/gm," "),o=new Blob([o],{type:"text/javascript"}),f=window.webkitURL||window.URL,p=new Worker(f.createObjectURL(o)),b=["start","progress","end","error","abort"],y={worker:p,queue:{},start:function(e){var t=e.file,r=e.url,n=e.headers,o=e.method,o=void 0===o?"PUT":o,a=l(e,d),e="".concat(u),i=c({id:e,url:r,file:{name:t.name,type:t.type,size:t.size,loaded:0,percent:0}},b.reduce(function(e,t){t="on".concat(s(t));return e[t]=a[t]||null,e},{}));return y.queue[e]=i,p.postMessage({action:"start-upload",id:e,url:r,file:t,method:o,headers:n}),e},abort:function(e){p.postMessage({action:"abort-upload",id:e})}};y.worker.onmessage=function(e){var t=e.data,e=e.data,r=e.id,e=e.action,n="on".concat(s(e)),o=y.queue[r];o&&b.includes(e)&&o[n]&&o[n](t),"onAbort"===n&&r in y.queue&&setTimeout(function(){delete y.queue[r]},500)};const m=y;module.exports=e})();